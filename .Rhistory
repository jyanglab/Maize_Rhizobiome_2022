#geom_jitter(position = position_jitter(0.2)) +
#theme_classic() +
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
#theme(axis.title.y=element_blank(),axis.text.y = element_text(size=20,color="black"),axis.ticks.y=element_blank()) +
#theme(legend.position = "none")
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("#c00001", "#000080")) #+
#geom_jitter(position = position_jitter(0.2)) +
#theme_classic() +
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
#theme(axis.title.y=element_blank(),axis.text.y = element_text(size=20,color="black"),axis.ticks.y=element_blank()) +
#theme(legend.position = "none")
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("#c00001", "#000080")) #+
geom_jitter(position = position_jitter(0.2)) +
#theme_classic() +
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
#theme(axis.title.y=element_blank(),axis.text.y = element_text(size=20,color="black"),axis.ticks.y=element_blank()) +
#theme(legend.position = "none")
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("#c00001", "#000080")) +
geom_jitter(position = position_jitter(0.2)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("darkred", "lightblue")) +
geom_jitter(position = position_jitter(0.2)) +
theme_classic() +
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
#theme(axis.title.y=element_blank(),axis.text.y = element_text(size=20,color="black"),axis.ticks.y=element_blank()) +
#theme(legend.position = "none")
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("darkred", "lightblue")) +
geom_jitter(position = position_jitter(0.2)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2) aes(fill=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(fill=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(fill=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic() +
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
#theme(axis.title.y=element_blank(),axis.text.y = element_text(size=20,color="black"),axis.ticks.y=element_blank()) +
#theme(legend.position = "none")
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35, outlier.shape = "none") +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic() +
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
#theme(axis.title.y=element_blank(),axis.text.y = element_text(size=20,color="black"),axis.ticks.y=element_blank()) +
#theme(legend.position = "none")
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35, outlier.shape = "none") +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = "crosshatch", pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
?scale_pattern_manual
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
scale_pattern_manual(values= c("points", "crosshatch")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
scale_pattern_manual(values= c("point", "crosshatch")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
scale_pattern_manual(values= c("stripe", "crosshatch")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
scale_pattern_manual(values= c("crosshatch", "stripe")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" ="stripe")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
scale_pattern_manual(values= c("task2" = "crosshatch", "task1" ="stripe")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("red", "lightblue")) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" ="stripe")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_density_manual(values= c("task1" = 0.3, "task2" = 0.7)) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_density_manual(values= c("task1" = 0.1, "task2" = 0.9)) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
#scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
#scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_density_manual(values= c("task1" = 0.1, "task2" = 0.9)) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
#scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
#scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_density_manual(values= c( 0.1, 0.9)) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
#scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
#scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_density_manual(values= c( 0.35, 0.35)) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), outlier.shape = NA) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), outlier.shape = NA) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
scale_pattern_density_manual(values=c("task1" = 0.35, "task2" = 0.7)) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
?scale_pattern_density_manual
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), outlier.shape = NA) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
scale_pattern_density_manual(values=c(0.35, 0.7)) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
ggplot(plot_data, aes(x=Species, y=Sepal.Length)) +
geom_boxplot_pattern(aes(pattern = task, pattern_fill = task), pattern_density = 0.35, outlier.shape = NA) +
scale_pattern_manual(values= c("task1" = "crosshatch", "task2" = "stripe")) +
scale_pattern_fill_manual(values=c("task1" = "red", "task2" = "lightblue")) +
geom_jitter(position = position_jitter(0.2), aes(color=task)) +
theme_classic()
setwd("~/Desktop/Labwork/Havelock_2019/Maize_Rhizobiome_2022")
load("cache/MAPL_genes_613.rda")
load("cache/MAPL_genes_613.rda")
View(MAPL_genes)
unique(MAPL_genes$genes)
length(unique(MAPL_genes$genes))
length(unique(MAPL_genes$genes))
load("cache/MAPL_genes_119.rda")
load("cache/MAPL_genes_119.rda")
View(MAPL_genes)
length(unique(MAPL_genes$genes))
library(tidyverse)
test <- MAPL_genes %>%
group_by(nitrogen, chr, bin) %>%
add_tally()
View(test)
fpkm <- read_csv("data/FPKM_Old_new_four_lines2.csv") ## Gen Xu gene expression data
fpkm <- rename(fpkm, gene=X1)
View(fpkm)
View(fpkm)
fpkm <- read_csv("data/FPKM_Old_new_four_lines2.csv") ## Gen Xu gene expression data
View(fpkm)
View(fpkm)
colnames(fpkm)[1]
colnames(fpkm)[1] <- "gene"
View(fpkm)
N_plot_data <- fpkm %>%
filter(gene %in% locus_genes) %>%
##dplyr::select(gene, contains("Root")) %>%
pivot_longer(-gene, names_to = "Sample", values_to = "fpkm") %>%
separate(Sample, c("nitrogen", "genotype", "tissue", "rep"), sep = "_") %>%
mutate(nitrogen = ifelse(nitrogen == "HN", "+N", "-N"))
colors <- c("leaf"="#76ba1b", "Root" = "#dca85c")
View(MAPL_genes)
load("cache/MAPL_genes_119.rda")
View(MAPL_genes)
load("../HAVELOCK_BG/cache/RNAseq/MAPL_rna.rda")
load("../HAVELOCK_BG/cache/RNAseq/MAPL_rna.rda")
View(MAPL_rna)
length(unique(MAPL_rna$gene))
load("data/mean_gene_expression_by_tissue_type_4genotypes.rda")
View(mean_gene_expression)
load("cache/genes_in_7_tissue_data.rda")
load("../HAVELOCK_BG/cache/genes_in_7_tissue_data.rda")
View(MAPL_rna)
load("../HAVELOCK_BG/cache/RNAseq/MAPL_rna.rda")
View(MAPL_rna)
locus_genes <- c("Zm00001d023838", "Zm00001d023839", "Zm00001d023840")
locus_gene_exp <- MAPL_rna %>%
filter(gene %in% locus_genes)
locus_genes <- c("Zm00001d023838", "Zm00001d023839", "Zm00001d023840")
load("cache/RNAseq/MAPL_rna.rda")
load("../HAVELOCK_BG/cache/RNAseq/MAPL_rna.rda")
locus_gene_exp <- MAPL_rna %>%
filter(gene %in% locus_genes)
## min vs. major allele data at locus
load("../HAVELOCK_BG/cache/GWAS2/hmp_data_candidate_Comamonadaceae.rda")
tgr <- "f_Comamonadaceae Unknown Genus"
snp <- "S10_23954233"
chr <- "10"
allele_df_com <- hmp_data_candidates %>%
filter(snp_id == "S10_23954233" & tax_group == "f_Comamonadaceae Unknown Genus") %>%
ungroup() %>%
dplyr::select(GX_name, allele) %>%
unique()
plot_data <- locus_gene_exp %>%
left_join(allele_df_com) %>%
filter(allele != "NA") %>%
filter(tissue != "L3Mid")
#filter(tissue == "GRoot")
load("../HAVELOCK_BG/cache/RNAseq/MAPL_rna.rda")
locus_gene_exp <- MAPL_rna %>%
filter(gene %in% locus_genes)
## min vs. major allele data at locus
load("../HAVELOCK_BG/cache/GWAS2/hmp_data_candidate_Comamonadaceae.rda")
tgr <- "f_Comamonadaceae Unknown Genus"
snp <- "S10_23954233"
chr <- "10"
allele_df_com <- hmp_data_candidates %>%
filter(snp_id == "S10_23954233" & tax_group == "f_Comamonadaceae Unknown Genus") %>%
ungroup() %>%
dplyr::select(GX_name, allele) %>%
unique()
plot_data <- locus_gene_exp %>%
left_join(allele_df_com) %>%
filter(allele != "NA") %>%
filter(tissue != "L3Mid")
#filter(tissue == "GRoot")
View(locus_gene_exp)
View(allele_df_com)
locus_gene_exp <- MAPL_rna %>%
filter(gene %in% locus_genes)
View(locus_gene_exp)
## min vs. major allele data at locus
load("../HAVELOCK_BG/cache/GWAS2/hmp_data_candidate_Comamonadaceae.rda")
View(allele_df_com)
load("../HAVELOCK_BG/cache/GWAS2/hmp_data_candidate_Comamonadaceae.rda")
View(hmp_data_candidates)
hmp_data_candidates <- hmp_data_candidates %>%
rename(genotype=GX_name)
View(hmp_data_candidates)
hmp_data_candidates <- hmp_data_candidates %>%
rename(genotype=GX_name)
## min vs. major allele data at locus
load("../HAVELOCK_BG/cache/GWAS2/hmp_data_candidate_Comamonadaceae.rda")
tgr <- "f_Comamonadaceae Unknown Genus"
snp <- "S10_23954233"
chr <- "10"
allele_df_com <- hmp_data_candidates %>%
filter(snp_id == "S10_23954233" & tax_group == "f_Comamonadaceae Unknown Genus") %>%
ungroup() %>%
dplyr::select(GX_name, allele) %>%
unique()
plot_data <- locus_gene_exp %>%
left_join(allele_df_com)
View(locus_gene_exp)
allele_df_com <- hmp_data_candidates %>%
filter(snp_id == "S10_23954233" & tax_group == "f_Comamonadaceae Unknown Genus") %>%
ungroup() %>%
dplyr::select(GX_name, allele) %>%
rename(genotype=GX_name)
unique()
allele_df_com <- hmp_data_candidates %>%
filter(snp_id == "S10_23954233" & tax_group == "f_Comamonadaceae Unknown Genus") %>%
ungroup() %>%
dplyr::select(GX_name, allele) %>%
rename(genotype=GX_name) %>%
unique()
plot_data <- locus_gene_exp %>%
left_join(allele_df_com) %>%
filter(allele != "NA") %>%
filter(tissue != "L3Mid")
colors <- c("major allele"="#ecb602", "minor allele"="#a45ee5", "NA"="#666666")
## abundance major vs minor allele
ggplot(plot_data, aes(x=tissue, y=expression, fill=allele)) +
geom_boxplot(outlier.shape = NA) +
geom_point(pch = 21, size = 1, position = position_jitterdodge(jitter.width = 0.1)) +
stat_compare_means(aes(group = allele), label = "p.signif") +
ylab("gene expression (FPKM)") +
facet_wrap(~gene, scale = "free_y") +
scale_fill_manual(values = colors) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
#theme(axis.title.x=element_blank(),
#      axis.text.x=element_blank(),
#      axis.ticks.x=element_blank())
library("tidyverse")
library("LDheatmap")
library("genetics")
library("ggpubr")
library("ggpmisc")
## abundance major vs minor allele
ggplot(plot_data, aes(x=tissue, y=expression, fill=allele)) +
geom_boxplot(outlier.shape = NA) +
geom_point(pch = 21, size = 1, position = position_jitterdodge(jitter.width = 0.1)) +
stat_compare_means(aes(group = allele), label = "p.signif") +
ylab("gene expression (FPKM)") +
facet_wrap(~gene, scale = "free_y") +
scale_fill_manual(values = colors) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
#theme(axis.title.x=element_blank(),
#      axis.text.x=element_blank(),
#      axis.ticks.x=element_blank())
## KREMLING gen expression data
load("../HAVELOCK_BG/cache/RNAseq/MAPL_rna.rda")
#load("cache/GWAS2/hmp_data_candidates.rda")
#load("data/yield_analysis/abundance_vs_phenotype.rda")
locus_gene_exp <- MAPL_rna %>%
filter(gene %in% locus_genes)
## min vs. major allele data at locus
load("../HAVELOCK_BG/cache/GWAS2/hmp_data_candidate_Comamonadaceae.rda")
tgr <- "f_Comamonadaceae Unknown Genus"
snp <- "S10_23954233"
chr <- "10"
allele_df_com <- hmp_data_candidates %>%
filter(snp_id == "S10_23954233" & tax_group == "f_Comamonadaceae Unknown Genus") %>%
ungroup() %>%
dplyr::select(GX_name, allele) %>%
rename(genotype=GX_name) %>%
unique()
plot_data <- locus_gene_exp %>%
left_join(allele_df_com) %>%
filter(allele != "NA") %>%
filter(tissue != "L3Mid")
#filter(tissue == "GRoot")
colors <- c("major allele"="#ecb602", "minor allele"="#a45ee5", "NA"="#666666")
locus_genes <- c("Zm00001d023838", "Zm00001d023839", "Zm00001d023840")
load("../HAVELOCK_BG/cache/RNAseq/MAPL_rna.rda")
#load("cache/GWAS2/hmp_data_candidates.rda")
#load("data/yield_analysis/abundance_vs_phenotype.rda")
locus_gene_exp <- MAPL_rna %>%
filter(gene %in% locus_genes)
## min vs. major allele data at locus
load("../HAVELOCK_BG/cache/GWAS2/hmp_data_candidate_Comamonadaceae.rda")
tgr <- "f_Comamonadaceae Unknown Genus"
snp <- "S10_23954233"
chr <- "10"
allele_df_com <- hmp_data_candidates %>%
filter(snp_id == "S10_23954233" & tax_group == "f_Comamonadaceae Unknown Genus") %>%
ungroup() %>%
dplyr::select(GX_name, allele) %>%
rename(genotype=GX_name) %>%
unique()
plot_data <- locus_gene_exp %>%
left_join(allele_df_com) %>%
filter(allele != "NA") %>%
filter(tissue != "L3Mid")
#filter(tissue == "GRoot")
colors <- c("major allele"="#ecb602", "minor allele"="#a45ee5", "NA"="#666666")
by_tissue_data <- plot_data %>%
filter(tissue %in% c("GRoot", "GShoot"))
colors <- c("GShoot"="#76ba1b", "GRoot" = "#dca85c")
ggplot(by_tissue_data, aes( x = gene, y=expression, fill=tissue)) +
geom_boxplot(outlier.shape = NA) +
geom_point(pch = 21, size = 1, position = position_jitterdodge(jitter.width = 0.1)) +
stat_compare_means(aes(group = tissue), label = "p.signif") +
ylab("gene expression (FPKM)") +
facet_wrap(~gene, scales = "free") +
scale_fill_manual(values = colors) +
theme_bw()
### Gen gene expression data 4 genotypes with N treatment
fpkm <- read_csv("data/RNA_seq/FPKM_Old_new_four_lines2.csv")
fpkm <- rename(fpkm, gene=X1)
N_plot_data <- fpkm %>%
filter(gene %in% locus_genes) %>%
##dplyr::select(gene, contains("Root")) %>%
pivot_longer(-gene, names_to = "Sample", values_to = "fpkm") %>%
separate(Sample, c("nitrogen", "genotype", "tissue", "rep"), sep = "_") %>%
mutate(nitrogen = ifelse(nitrogen == "HN", "+N", "-N"))
colors <- c("leaf"="#76ba1b", "Root" = "#dca85c")
ggplot(N_plot_data, aes(x=nitrogen, y=fpkm, fill=tissue)) +
geom_boxplot(outlier.shape = NA) +
geom_point(pch = 21, size = 1, position = position_jitterdodge(jitter.width = 0.1)) +
stat_compare_means(aes(group = tissue), label = "p.signif") +
ylab("gene expression (FPKM)") +
facet_wrap(~gene) +
scale_fill_manual(values = colors) +
theme_bw()
fpkm <- read_csv("data/FPKM_Old_new_four_lines2.csv")
View(fpkm)
colnames(fpkm)[1] <- "gene"
N_plot_data <- fpkm %>%
filter(gene %in% locus_genes) %>%
##dplyr::select(gene, contains("Root")) %>%
pivot_longer(-gene, names_to = "Sample", values_to = "fpkm") %>%
separate(Sample, c("nitrogen", "genotype", "tissue", "rep"), sep = "_") %>%
mutate(nitrogen = ifelse(nitrogen == "HN", "+N", "-N"))
colors <- c("leaf"="#76ba1b", "Root" = "#dca85c")
ggplot(N_plot_data, aes(x=nitrogen, y=fpkm, fill=tissue)) +
geom_boxplot(outlier.shape = NA) +
geom_point(pch = 21, size = 1, position = position_jitterdodge(jitter.width = 0.1)) +
stat_compare_means(aes(group = tissue), label = "p.signif") +
ylab("gene expression (FPKM)") +
facet_wrap(~gene) +
scale_fill_manual(values = colors) +
theme_bw()
locus_genes <- c("Zm00001d023838", "Zm00001d023839", "Zm00001d023840")
fpkm <- read_csv("data/FPKM_Old_new_four_lines2.csv")
colnames(fpkm)[1] <- "gene"
N_plot_data <- fpkm %>%
filter(gene %in% locus_genes) %>%
##dplyr::select(gene, contains("Root")) %>%
pivot_longer(-gene, names_to = "Sample", values_to = "fpkm") %>%
separate(Sample, c("nitrogen", "genotype", "tissue", "rep"), sep = "_") %>%
mutate(nitrogen = ifelse(nitrogen == "HN", "+N", "-N"))
colors <- c("leaf"="#76ba1b", "Root" = "#dca85c")
ggplot(N_plot_data, aes(x=nitrogen, y=fpkm, fill=tissue)) +
geom_boxplot(outlier.shape = NA) +
geom_point(pch = 21, size = 1, position = position_jitterdodge(jitter.width = 0.1)) +
stat_compare_means(aes(group = tissue), label = "p.signif") +
ylab("gene expression (FPKM)") +
facet_wrap(~gene) +
scale_fill_manual(values = colors) +
theme_bw()
### Gen gene expression data for chr 10 locus genes
#4 genotypes with N treatment
locus_genes <- c("Zm00001d023838", "Zm00001d023839", "Zm00001d023840")
fpkm <- read_csv("data/FPKM_Old_new_four_lines2.csv")
colnames(fpkm)[1] <- "gene"
N_plot_data <- fpkm %>%
filter(gene %in% locus_genes) %>%
##dplyr::select(gene, contains("Root")) %>%
pivot_longer(-gene, names_to = "Sample", values_to = "fpkm") %>%
separate(Sample, c("nitrogen", "genotype", "tissue", "rep"), sep = "_") %>%
mutate(nitrogen = ifelse(nitrogen == "HN", "+N", "-N"))
colors <- c("leaf"="#76ba1b", "Root" = "#dca85c")
ggplot(N_plot_data, aes(x=nitrogen, y=fpkm, fill=tissue)) +
geom_boxplot(outlier.shape = NA) +
geom_point(pch = 21, size = 1, position = position_jitterdodge(jitter.width = 0.1)) +
stat_compare_means(aes(group = tissue), label = "p.signif") +
ylab("gene expression (FPKM)") +
facet_wrap(~gene) +
scale_fill_manual(values = colors) +
theme_bw()
